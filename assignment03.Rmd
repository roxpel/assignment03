---
title: "Assignment 03"
author: "Roxane Peloux"
date: "2/9/2020"
output: html_document
---


# Better Life Performances of OECD countries based on OECD's Better Life Index data 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:
```{r}
library(readr)
BetterLifeIndex <- read_csv("BetterLifeIndex.csv")
View(BetterLifeIndex)

library(dplyr)
library(ggplot2)
library(tidyverse)
library(stringr)
```

```{r}
names(BetterLifeIndex) 
str(BetterLifeIndex)
```
```{r}
unique(BetterLifeIndex$Indicator)
unique(BetterLifeIndex$Country)
unique(BetterLifeIndex$Unit)
```

```{r}
view(BetterLifeIndex)
```

```{r}

# Creating dataframe of only European OECD countries

BetterLifeIndex_European <- BetterLifeIndex %>%
  select(Country, Indicator, Inequality, Unit, Value) %>%
  filter(Country == "Austria" | Country == "Belgium" | Country == "Czech Republic" | Country == "Denmark" | Country == "Finland" | Country == "France" | Country == "Germany" | Country == "Greece" | Country == "Hungary" | Country == "Iceland" | Country == "Ireland" | Country == "Italy" | Country == "Luxembourg" | Country == "Netherlands" | Country == "Norway" | Country == "Poland" | Country == "Portugal" | Country == "Sloval Republic" | Country == "Spain" | Country == "Estonia" | Country == "Latvia" | Country == "Russia" | Country == "Slovenia")

# Creating dataframe of only European OECD countries for negative indicators 

BetterLifeIndex_European_bad <- BetterLifeIndex_European %>%
  select(Country, Indicator, Inequality, Unit, Value) %>%
  filter(Indicator == "Air pollution" | Indicator == "Dwellings without basic facilities" | Indicator == "Employees working very long hours" | Indicator == "Homicide rate" | Indicator == "Long-term unemployment rate")
  
# Creating a bar chart showing performance of OECD countries on negative indicators

  ggplot(BetterLifeIndex_European_bad, aes(x = reorder(Country, -Value), y = Value, fill = Indicator)) + geom_bar(stat = "identity") +
  coord_flip() +
  labs(title = "Better life index performance on negative indicators \nfor European OECD countries", x = "Country", y = "Average score", caption = "The Average score for the different indicators is calculated \nin percentages, scores, ratio, US dollar, years, micrograms per cubic meter, or hours.", hjust = 1) 
    
```
```{r}

# Creating new dataframe with safety and life satisfaction indicators for all countries to measure their correlation

BetterLifeIndex_Safety_Satisfaction <- spread(BetterLifeIndex, Indicator, Value)

BetterLifeIndex_Safety_Satisfaction <- BetterLifeIndex_Safety_Satisfaction[,c("Country", "Feeling safe walking alone at night", "Life satisfaction")]
  

BetterLifeIndex_Safety_Satisfaction <- BetterLifeIndex_Safety_Satisfaction %>% group_by(Country) %>% summarise()



ggplot(BetterLifeIndex_Safety_Satisfaction, aes("Feeling safe walking alone at night", "Life satisfaction")) + geom_point(aes(color = "Country"))


view(BetterLifeIndex_Safety_Satisfaction)

```

```{r}
BetterLifeIndex_pct_LifeSatisfaction <- BetterLifeIndex %>%
  select(Country, Indicator, Inequality, Unit, Value) %>%
  filter(Inequality == "Total", Unit == "Percentage", Indicator == "Feeling safe walking alone at night")



count(BetterLifeIndex_pct, vars = Unit, wt_var = Country)

BetterLifeIndex_pct_France <- BetterLifeIndex_pct %>%
  select(Country, Indicator, Inequality, Unit, Value) %>%
  filter(Country == "France")


```








