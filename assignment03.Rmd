---
title: "Assignment 03"
author: "Roxane Peloux"
date: "2/9/2020"
output: html_document
---


# Better Life Performances of OECD countries based on OECD's Better Life Index data 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:
```{r}
library(readr)
BetterLifeIndex <- read_csv("BetterLifeIndex.csv")
View(BetterLifeIndex)

library(dplyr)
library(ggplot2)
library(tidyverse)
library(ggalt)
```

```{r}
names(BetterLifeIndex) 
str(BetterLifeIndex)
```
```{r}
unique(BetterLifeIndex$Indicator)
unique(BetterLifeIndex$Country)
unique(BetterLifeIndex$Unit)
```

```{r}
view(BetterLifeIndex)
```

```{r}

# Creating dataframe of only European OECD countries

BetterLifeIndex_European <- BetterLifeIndex %>%
  select(Country, Indicator, Inequality, Unit, Value) %>%
  filter(Country == "Austria" | Country == "Belgium" | Country == "Czech Republic" | Country == "Denmark" | Country == "Finland" | Country == "France" | Country == "Germany" | Country == "Greece" | Country == "Hungary" | Country == "Iceland" | Country == "Ireland" | Country == "Italy" | Country == "Luxembourg" | Country == "Netherlands" | Country == "Norway" | Country == "Poland" | Country == "Portugal" | Country == "Sloval Republic" | Country == "Spain" | Country == "Estonia" | Country == "Latvia" | Country == "Russia" | Country == "Slovenia")

# Creating dataframe of only European OECD countries for negative indicators 

BetterLifeIndex_European_bad <- BetterLifeIndex_European %>%
  select(Country, Indicator, Inequality, Unit, Value) %>%
  filter(Indicator == "Air pollution" | Indicator == "Dwellings without basic facilities" | Indicator == "Employees working very long hours" | Indicator == "Homicide rate" | Indicator == "Long-term unemployment rate")
  
# Creating a bar chart showing performance of OECD countries on negative indicators

  ggplot(BetterLifeIndex_European_bad, aes(x = reorder(Country, -Value), y = Value, fill = Indicator)) + geom_bar(stat = "identity") +
  coord_flip() +
  labs(title = "Better life index performance on negative indicators \nfor European OECD countries", x = "Country", y = "Average score", caption = "The Average score for the different indicators is calculated \nin percentages, scores, ratio, US dollar, years, micrograms per cubic meter, or hours.", hjust = 1) 
    
```
```{r}

# Creating new dataframe with health and life satisfaction indicators for all countries to measure their correlation

Leisure <- BetterLifeIndex %>%
  filter(Indicator == "Time devoted to leisure and personal care" & Inequality == "Total") %>%
  select(Country, Value)

Life_Satisfaction <- BetterLifeIndex %>%
  filter(Indicator == "Life satisfaction" & Inequality == "Total") %>%
  select(Country, Value)

BetterLifeIndex_Leisure_Satisfaction <- inner_join(Leisure, Life_Satisfaction, by = "Country")

# Creating scatterplot
 
ggplot(BetterLifeIndex_Leisure_Satisfaction[1:38,], aes(Value.x, Value.y)) + geom_point() +
  geom_point(data = BetterLifeIndex_Leisure_Satisfaction[39,], color = "blue") +
  labs(
    x = "Time devoted to leisure and personal care",
    y = "Life satisfaction",
    title = "Does more leisure make you happier?"
  )

```

```{r}

# Creating two dataframes for gender inequality in income

BetterLifeIndex_Income_Disparity_Men <- BetterLifeIndex %>% filter(Indicator == "Household net adjusted disposable income" & Inequality == "Men") %>% select(Country, Value)
  
BetterLifeIndex_Income_Disparity_Women <- BetterLifeIndex %>% filter(Indicator == "Household net adjusted disposable income" & Inequality == "Women") %>% select(Country, Value)
 
# Creating a new dataframe for gender dispartity in income by merging the two datasets

BetterLifeIndex_Income_Disparity <- inner_join(BetterLifeIndex_Income_Disparity_Women, BetterLifeIndex_Income_Disparity_Men, by = "Country")

view(BetterLifeIndex_Income_Disparity)
```

```{r}
ggplot(BetterLifeIndex_Income_Disparity) + 
  geom_dumbbell(aes(x = Value.x, xend = Value.y, y = Country, group = Country), size = 1.5)
#  geom_segment(aes(x = Value.x, xend = Value.y, y = Country, yend = Country), size = 1.5, color = 'red')

# p <- ggplot(BetterLifeIndex_Income_Disparity) + geom_point(aes(x = Value.x, y = Country), size = 1.5) + 
#  geom_point(aes(x = Value.y, y = Country), size = 1.5)

# p + geom_path(aes(x = Value.x, xend = Value.y, y = Country, yend = Country), size = 1.5, alpha = 0.75)


# library(plotly)
# p <- plot_ly(BetterLifeIndex_Income_Disparity, color = I("gray80")) %>%
#   add_segments(x = ~Value.x, xend = ~Value.y, y = ~Country, yend = ~Country, showlegend = FALSE) %>%
#   add_markers(x = ~Value.x, y = ~Country, name = "Women", color = I("pink")) %>%
#   add_markers(x = ~Value.y, y = ~Country, name = "Men", color = I("blue")) %>%
#   layout(
#     title = "Gender earnings disparity",
#     xaxis = list(title = "Annual Salary (in thousands)"),
#     margin = list(l = 65)
#   )

```








